AWS CODESTAR
=

### 서버리스?  
- 서버에 대한 고민 없이 애플리케이션을 구축 및 작동  
- 서버리스는 그 단어의 뜻처럼 서버가 없는것이 아니라 서버가 없는것 처럼 세팅이 간편해지고 있다는 뜻이다.  
    
![serverless](/images/serverless.PNG)  


### serverless computing의 이점

![positive](/images/positive.PNG)   

### 서버리스 오픈소스 프레임워크를 통한 자동 배포
- 그렇다면 이를 어떻게 하면 쉽게 코드만 작성해서 배포까지 할수 있게 되었는가? 
![framework](/images/framework.PNG)   
- 오픈소스 프레임워크들이 생겨나고 있고, AWS 에서도 이를 만들게 된것이 AWS SAM (serverless applicatioln model)이다.   
- CloudFormation 기반이고, 람다함수와 기타 리소스도 배포하며, 정해진 템플릿에서 공개표준기반 (아파치2.0)으로 만들어졌다.  

### 일반적인 개발 및 배포 단계
-일반적으로 개인이 혼자서 서버리스 앱을 만들고 개발 배포하는것이 쉬운것은 아니다.   

![normal](/images/normal.PNG)   

### AWS 기반 개발 및 배포 단계 - 통합 개발환경

- codestar와 c9으로 빠르게 서버리스 개발 및 배포 환경구축  
- 클라우드 기반 IDE를 통한 개발 협업  
- 바로 앱 패키징 및 자동 배포 가능  

![aws_dev](/images/aws_dev.png)   

### 서버리스 아키텍처 - 주요 AWS 빌딩 블록 

- 추가적으로 몇가지의 AWS 빌딩 블록들도 있는것을 알고있다면 좋다.  
![block](/images/block.PNG)   

### 서버리스 앱 개발 및 배포 과정 
* AWS CodeStar로 샘플 앱 프로젝트 (API 호출 시 간단한 HTML 파일 출력) 배포  
* 소스코드, 빌드, 배포 및 파이프라인 서비스 살펴보기
* 각종 AWS 리소스 생성 내역 확인하기
* AWS Cloud9 기반 클라우드 IDE로 수정 및 배포하기

### 데모 시작! 

#### [전반부](demo1.md)

#### 오류 있는 버전 pic25 ~ pic33

* 기본적으로 hello_page 컨트롤러 뷰 가 설정되어있는것을 확인할수 있다. 
* h1,h2 태그만 간단하게 바꾸어 보자 > 수정!
* 바로 깃 에드 커밋 푸시 까지해주면 바로 배포까지 자동으로 진행된다. 
* 여기서 주의 할것이 해당 터미널의 위치가 프로젝트 파일안으로 가야 한다. 
* 푸시가 끝나면 codestar 대시보드를 새로고침 해보면 커밋이 진행되고 빌드, 배포까지 자동으로 되는것을 확인할수 있다. 
* 이는 pipeline 메뉴에서 좀더 자세히 알수 있다. 
* 코드를 작성만 하면 수 분만에 배포까지 자동으로 되는것을 확인할수있다. 
* 잠시 기다려보면 코드가 빌드가 실패한것을 알수있다. 
* 코드 빌드로 들어가서 로그를 살펴보자 알고보니 기본 페이지가 템플릿으로 설정되어서 코드를 수정하면 오류가 나오는것을 알수있다. 
*  ctrl + z 로 원상태로 돌아가자! > 새로운 페이지를 임시로 만들어서 테스트 해주자.
* 다시 깃 에드 커밋 푸시
* 해당 에러를 읽어보면 spec> controller > hello_page_controller_spec.rb 파일을 보면 알수있다. 

#### 오류 없는 버전 pic34
* h2를 바꾸고 깃 에드, 커밋, 푸시 !

#### 합쳐지는 지점 pic35 ~ pic 43
* 잠시동안 커밋, 빌드, 배포를 기다려주면 페이지가 나오는것을 확인할수있다. 
* 수정까지 끝났으면 codepipeline을 조금 살펴보는것으로 마무리 해보겠다. 
* 파이프라인 우상단의 편집을 클릭
* 스테이지를 본인이 편한대로 추가/삭제/편집 할수있다.
* 간단하게 github remote를 추가해보겠다. 
* 편집: Source 오른쪽의 스테이지편집 선택
* 작업 추가(github), 공급자 github 설정 깃헙에 연결을 클릭하고, 로그인, 레포지토리 선택,브랜치 선택하고 저장
* 성공적으로 작업이 끝난것을 확인할수있다. 완료를 누르고 저장 
* 파이프라인 변경사항 저장
* 코드를 일부 수정하고 깃 에드 커밋 푸시(git push github master)를 해준다.
* codepipeline이 실행되는것을 알수있고, 리모트가 연결된 깃헙을 들어가면 코드가 반영된것이 확인된다. 
* 파이프라인이 다 실행되고 웹 어플리케이션을 새로고침하면 페이지에 변경사항이 적용된것이 확인된다.

### 데모 끝! 
* 코드스타 여러가지를 살펴보면서 기능을 좀더 탐구해보는것을 추천한다. 
* 데모가 끝났으니 EC2 에서 codestar 인스턴스를 종료해준다. 
* 해당 인스턴스를 종료할때 데이터가 사라진다고 했으나 cloud9과 연결되있고, github에도 연결되있기 때문에 데이터 걱정없이 멈추어주자
* 이제 cloud9으로 작업하고 서버 필요할때마다 켜서 사용하면 된다. 